<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="http://oauth.googlecode.com/svn/code/javascript/oauth.js"></script>
<script src="http://oauth.googlecode.com/svn/code/javascript/sha1.js"></script>
<script src="js/TwitterAPIKey.js"></script>
<script src="js/TwitterAPI.js"></script>
<script src="js/Table.js"></script>
<script src="js/lib/jquery-2.1.4.min.js"></script>
<script src="js/lib/jquery.datetimepicker.full.js"></script>
<link rel="stylesheet" type="text/css" href="css/main.css">
<link rel="stylesheet" type="text/css" href="css/jquery.datetimepicker.css">
<title>TwitterClient</title>
</head>
<body>
<h1>Twitter, Client!</h1>
<div>
<label>search mode：</label>
<input id="searchAccount" type="radio" name="searchMode" value="account" checked="checked" onchange="changeRadio();">
<label for="searchAccount">account</label>
<input id="searchTweet" type="radio" name="searchMode" value="tweet" onchange="changeRadio();">
<label for="searchTweet">tweet</label>
</div>
<div>
<label>serach option：</label>
<input id="datetimepickerUntil" type="text" style="display:none">
<input type="number" style="width:30px;" id="count" min="10" max="100" step="10" required>件
</div>
<label>serach word：</label>
<input id="searchWord" type="search" placeholder="search account">
<input type="submit" value="検索" onclick="getTwitter();">
<div id="tweetList" style="width:900px;align:center;"></div>
<script type="text/javascript">
$(function(){
$('#datetimepickerUntil').datetimepicker({
    timepicker: false,//時間非表示
    format: 'Y-m-d'//フォーマット指定
  });
});
function getTwitter() {
  var searchWord = document.getElementById('searchWord');
  var count = document.getElementById('count');
  var until = document.getElementById('datetimepickerUntil');
  var tw = new TwitterAPI(requestURL, 'resultsOutput');
  var radioValue = $("[name=searchMode]:checked").val();
  if (radioValue == 'account') {
    var requestURL = "https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=" + searchWord.value + '&count=' + count.value;
    tw = new TwitterAPI(requestURL, 'resultsOutputAccount');
  } else if (radioValue == 'tweet') {
    var requestURL = "https://api.twitter.com/1.1/search/tweets.json?q=" + searchWord.value + '&count=' + count.value + '&until=' + until.value;
    tw = new TwitterAPI(requestURL, 'resultsOutput');
  }
  console.log(tw);
  OAuth.setTimestampAndNonce(tw.message);
  OAuth.SignatureMethod.sign(tw.message,tw.accessor);
  var url = OAuth.addToURL(tw.message.action, tw.message.parameters);
  $.ajax({
    type: tw.method,
    url: url,
    dataType: "jsonp",
    jsonp:false,
    cache: true
  });
}

function changeRadio() {
  var radioValue = $("[name=searchMode]:checked").val();
  if (radioValue == 'tweet') {
    var datetimepicker = document.getElementById('datetimepickerUntil');
    datetimepicker.style.display = "";
  } else if (radioValue == "account") {
    var datetimepicker = document.getElementById('datetimepickerUntil');
    datetimepicker.style.display = "none";
  }
}
</script>
</body>
</html>